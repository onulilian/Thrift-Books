[{"C:\\Users\\OGOYI\\Desktop\\Thrift-Books\\src\\index.js":"1","C:\\Users\\OGOYI\\Desktop\\Thrift-Books\\src\\App.js":"2","C:\\Users\\OGOYI\\Desktop\\Thrift-Books\\src\\reportWebVitals.js":"3","C:\\Users\\OGOYI\\Desktop\\Thrift-Books\\src\\components\\Books.js":"4","C:\\Users\\OGOYI\\Desktop\\Thrift-Books\\src\\components\\Navbar.js":"5","C:\\Users\\OGOYI\\Desktop\\Thrift-Books\\src\\components\\Forms.js":"6"},{"size":480,"mtime":1645619425382,"results":"7","hashOfConfig":"8"},{"size":4329,"mtime":1653314340928,"results":"9","hashOfConfig":"8"},{"size":362,"mtime":1645619164806,"results":"10","hashOfConfig":"8"},{"size":1158,"mtime":1653395442165,"results":"11","hashOfConfig":"8"},{"size":847,"mtime":1653314326513,"results":"12","hashOfConfig":"8"},{"size":1797,"mtime":1653314332463,"results":"13","hashOfConfig":"8"},{"filePath":"14","messages":"15","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"16"},"19rndwm",{"filePath":"17","messages":"18","errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"19","usedDeprecatedRules":"16"},{"filePath":"20","messages":"21","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"16"},{"filePath":"22","messages":"23","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"24","messages":"25","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"16"},{"filePath":"26","messages":"27","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"16"},"C:\\Users\\OGOYI\\Desktop\\Thrift-Books\\src\\index.js",[],["28","29"],"C:\\Users\\OGOYI\\Desktop\\Thrift-Books\\src\\App.js",["30","31","32"],"import './App.css';\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport Navbar from \"./components/Navbar\";\r\nimport { useState, useEffect, useCallback } from \"react\";\r\n\r\n\r\n\r\n\r\nimport Web3 from \"web3\";\r\nimport { newKitFromWeb3 } from \"@celo/contractkit\";\r\nimport BigNumber from \"bignumber.js\";\r\nimport IERC from \"./contract/IERC.abi.json\";\r\nimport Thriftbook from  './contract/Thriftbook.abi.json';\r\nimport Books from './components/Books';\r\nimport Forms from './components/Forms';\r\n\r\n\r\nconst ERC20_DECIMALS = 18;\r\n\r\n\r\nconst contractAddress = \"0x9c2D6C44A7Dbf43D4d365015ac870618fdd50B01\";\r\nconst cUSDContractAddress = \"0x874069Fa1Eb16D44d622F2e0Ca25eeA172369bC1\";\r\n\r\n\r\n\r\nfunction App() {\r\n\r\n  const [contract, setcontract] = useState(null);\r\n  const [address, setAddress] = useState(null);\r\n  const [kit, setKit] = useState(null);\r\n  const [cUSDBalance, setcUSDBalance] = useState(0);\r\n  const [books, setBooks] = useState([]);\r\n\r\n  const connectToWallet = async () => {\r\n    if (window.celo) {\r\n      try {\r\n        await window.celo.enable();\r\n        const web3 = new Web3(window.celo);\r\n        let kit = newKitFromWeb3(web3);\r\n\r\n        const accounts = await kit.web3.eth.getAccounts();\r\n        const user_address = accounts[0];\r\n\r\n        kit.defaultAccount = user_address;\r\n\r\n        await setAddress(user_address);\r\n        await setKit(kit);\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    } else {\r\n      console.log(\"Error Occurred\");\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    connectToWallet();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (kit && address) {\r\n      getBalance();\r\n     \r\n    }\r\n  }, [kit, address]);\r\n\r\n  useEffect(() => {\r\n    if (contract) {\r\n      getBook();\r\n    }\r\n  }, [contract]);  \r\n\r\n\r\n\r\n  const getBalance = (async () => {\r\n    try {\r\n      const balance = await kit.getTotalBalance(address);\r\n      const USDBalance = balance.cUSD.shiftedBy(-ERC20_DECIMALS).toFixed(2);\r\n      const contract = new kit.web3.eth.Contract(Thriftbook, contractAddress);\r\n      setcontract(contract);\r\n      setcUSDBalance(USDBalance);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  });\r\n\r\n  const getBook = (async () => {\r\n    const booksLength = await contract.methods.getbooksLength().call();\r\n    const _buk = []\r\n    for (let index = 0; index < booksLength; index++) {\r\n      console.log(booksLength);\r\n      let _books = new Promise(async (resolve, reject) => {\r\n      let book = await contract.methods.getBook(index).call();\r\n\r\n      resolve({\r\n        index: index,\r\n        owner: [0],\r\n        url: book[1],\r\n        title: book[2],\r\n        author: book[3],\r\n        price: book[4],\r\n        like: book[5]\r\n\r\n                \r\n      });\r\n    });\r\n    _buk.push(_books);\r\n  }\r\n  const books = await Promise.all(_buk);\r\n  setBooks(books);\r\n  console.log(books)\r\n});\r\n\r\n  const buyBook = async (_index,) => {\r\n    try {\r\n      const cUSDContract = new kit.web3.eth.Contract(IERC, cUSDContractAddress);\r\n    \r\n      \r\n      await cUSDContract.methods\r\n        .approve(contractAddress, books[_index].price)\r\n        .send({ from: address });\r\n      await contract.methods.buyBook(_index).send({ from: address });\r\n      getBook();\r\n      getBalance();\r\n    } catch (error) {\r\n      console.log(error)\r\n    }};\r\n\r\n  \r\n  \r\n\r\nconst addBook = async (  _url, _title, _author, price ) => {\r\n  const _price = new BigNumber(price).shiftedBy(ERC20_DECIMALS).toString();\r\n  try {\r\n    await contract.methods\r\n      .addBook(_url, _title, _author, _price)\r\n      .send({ from: address });\r\n     getBook();\r\n  } catch (error) {\r\n    console.log(error);\r\n  }\r\n};\r\n \r\nconst DeleteBook = async (_index) => {\r\n  try {\r\n    await contract.methods.deleteBook(_index).send({ from: address });\r\n    getBook();\r\n    getBalance();\r\n  } catch (error) {\r\n    alert(error);\r\n  }};\r\n\r\n  const Like= async (_index) => {\r\n    try {\r\n      await contract.methods.Like(_index).send({ from: address });\r\n      getBook ();\r\n      getBalance();\r\n    } catch (error) {\r\n      alert.log(error);\r\n    }};\r\n   \r\n\r\n  return (\r\n    <div>\r\n      <Navbar balance = {cUSDBalance} />\r\n      <Books books ={books}\r\n      buyBook = {buyBook}\r\n      DeleteBook = {DeleteBook}\r\n      Like= {Like}\r\n      \r\n       \r\n      />\r\n       <Forms addBook = {addBook}\r\n       \r\n/>\r\n    </div>\r\n    )\r\n\r\n\r\n}\r\nexport default App;","C:\\Users\\OGOYI\\Desktop\\Thrift-Books\\src\\reportWebVitals.js",[],"C:\\Users\\OGOYI\\Desktop\\Thrift-Books\\src\\components\\Books.js",[],"C:\\Users\\OGOYI\\Desktop\\Thrift-Books\\src\\components\\Navbar.js",[],"C:\\Users\\OGOYI\\Desktop\\Thrift-Books\\src\\components\\Forms.js",[],{"ruleId":"33","replacedBy":"34"},{"ruleId":"35","replacedBy":"36"},{"ruleId":"37","severity":1,"message":"38","line":4,"column":31,"nodeType":"39","messageId":"40","endLine":4,"endColumn":42},{"ruleId":"41","severity":1,"message":"42","line":65,"column":6,"nodeType":"43","endLine":65,"endColumn":20,"suggestions":"44"},{"ruleId":"41","severity":1,"message":"45","line":71,"column":6,"nodeType":"43","endLine":71,"endColumn":16,"suggestions":"46"},"no-native-reassign",["47"],"no-negated-in-lhs",["48"],"no-unused-vars","'useCallback' is defined but never used.","Identifier","unusedVar","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'getBalance'. Either include it or remove the dependency array.","ArrayExpression",["49"],"React Hook useEffect has a missing dependency: 'getBook'. Either include it or remove the dependency array.",["50"],"no-global-assign","no-unsafe-negation",{"desc":"51","fix":"52"},{"desc":"53","fix":"54"},"Update the dependencies array to be: [kit, address, getBalance]",{"range":"55","text":"56"},"Update the dependencies array to be: [contract, getBook]",{"range":"57","text":"58"},[1631,1645],"[kit, address, getBalance]",[1723,1733],"[contract, getBook]"]